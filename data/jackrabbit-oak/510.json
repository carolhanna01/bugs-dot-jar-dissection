{
  "files": 1, 
  "singleLine": false, 
  "nb_error": 1, 
  "failing_tests": [
    "addEmptyMultiValue(org.apache.jackrabbit.oak.jcr.RepositoryTest): Invalid type: UNDEFINEDS"
  ], 
  "nb_test": 702, 
  "patch": "diff --git a/oak-jcr/src/main/java/org/apache/jackrabbit/oak/jcr/ItemImpl.java b/oak-jcr/src/main/java/org/apache/jackrabbit/oak/jcr/ItemImpl.java\nindex d59feb5..ba16709 100644\n--- a/oak-jcr/src/main/java/org/apache/jackrabbit/oak/jcr/ItemImpl.java\n+++ b/oak-jcr/src/main/java/org/apache/jackrabbit/oak/jcr/ItemImpl.java\n@@ -430,8 +430,12 @@ abstract class ItemImpl<T extends ItemDelegate> implements Item {\n         Value[] nonNullValues = compact(values);\n         int targetType = getType(definition, type);\n         if (nonNullValues.length == 0) {\n+            if (targetType == PropertyType.UNDEFINED) {\n+                // default to string when no other type hints are available\n+                targetType = PropertyType.STRING;\n+            }\n             return MemoryPropertyBuilder\n-                    .array(Type.fromTag(type, false), name)\n+                    .array(Type.fromTag(targetType, false), name)\n                     .getPropertyState();\n         } else if (targetType == type) {\n             return PropertyStates.createProperty(name, Arrays.asList(nonNullValues));\n", 
  "project": "jackrabbit-oak", 
  "linesAdd": 5, 
  "nb_skipped": 7, 
  "fix_commit": "f63d745a", 
  "nb_failure": 0, 
  "id": "510", 
  "linesRem": 1
}