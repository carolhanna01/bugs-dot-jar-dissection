{"nb_failure": 1, "nb_error": 0, "failing_tests": ["removeMoved(org.apache.jackrabbit.oak.core.RootImplTest)"], "patch": "diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java\nindex abda5d2..a868959 100644\n--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java\n+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java\n@@ -225,9 +225,7 @@ public class RootImpl implements Root {\n      * All registered {@link PurgeListener}s are notified.\n      */\n     private void purgePendingChanges() {\n-        if (hasPendingChanges()) {\n-            branch.setRoot(rootTree.getNodeState());\n-        }\n+        branch.setRoot(rootTree.getNodeState());\n         notifyListeners();\n     }\n \ndiff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java\nindex 79ffaff..63b1ec5 100644\n--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java\n+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java\n@@ -80,8 +80,10 @@ class KernelNodeStoreBranch implements NodeStoreBranch {\n \n     @Override\n     public void setRoot(NodeState newRoot) {\n-        currentRoot = newRoot;\n-        commit(buildJsop());\n+        if (!currentRoot.equals(newRoot)) {\n+            currentRoot = newRoot;\n+            commit(buildJsop());\n+        }\n     }\n \n     @Override\n", "nb_test": 203, "nb_skipped": 0, "fix_commit": "daf9a4ef", "id": "208"}