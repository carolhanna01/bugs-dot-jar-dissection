{
  "project": "karaf",
  "jira_id": "2645",
  "commit": "6650922f",
  "classification": {
    "singleLine": false
  },
  "patch": "diff --git a/instance/core/src/main/java/org/apache/karaf/instance/core/internal/InstanceServiceImpl.java b/instance/core/src/main/java/org/apache/karaf/instance/core/internal/InstanceServiceImpl.java\nindex 55a952938..0bfd6e1b5 100644\n--- a/instance/core/src/main/java/org/apache/karaf/instance/core/internal/InstanceServiceImpl.java\n+++ b/instance/core/src/main/java/org/apache/karaf/instance/core/internal/InstanceServiceImpl.java\n@@ -270,26 +270,46 @@ public class InstanceServiceImpl implements InstanceService {\n                 mkdir(karafBase, \"deploy\", printOutput);\n                 mkdir(karafBase, \"data\", printOutput);\n \n+                copyResourceToDir(karafBase, \"etc/all.policy\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/config.properties\", printOutput);\n-                copyResourceToDir(karafBase, \"etc/jre.properties\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/custom.properties\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/distribution.info\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/equinox-debug.properties\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/java.util.logging.properties\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.java.lang.Memory.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.org.apache.karaf.bundle.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.org.apache.karaf.config.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.org.apache.karaf.security.jmx.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jmx.acl.osgi.compendium.cm.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/jre.properties\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/keys.properties\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.apache.felix.fileinstall-deploy.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.bundle.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.config.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.feature.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.jaas.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.kar.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.shell.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.command.acl.system.cfg\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.apache.karaf.features.obr.cfg\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.apache.karaf.features.repos.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.jaas.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/org.apache.karaf.kar.cfg\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.apache.karaf.log.cfg\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.ops4j.pax.logging.cfg\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/org.ops4j.pax.url.mvn.cfg\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/regions-config.xml\", printOutput);\n+                copyResourceToDir(karafBase, \"etc/shell.init.script\", printOutput);\n                 copyResourceToDir(karafBase, \"etc/users.properties\", printOutput);\n-                copyResourceToDir(karafBase, \"etc/keys.properties\", printOutput);\n \n                 copyResourceToDir(karafBase, FEATURES_CFG, printOutput);\n                 addFeaturesFromSettings(new File(karafBase, FEATURES_CFG), settings);\n \n                 // The startup.properties is now generated by the karaf maven plugin, so\n                 // we use the one from the root instance instead of embedding it\n-                File curbase = new File(System.getProperty(\"karaf.base\"));\n-                copy(new File(curbase, \"etc/startup.properties\"), new File(karafBase, \"etc/startup.properties\"));\n+                File rootEtc = new File(System.getProperty(\"karaf.etc\"));\n+                copy(new File(rootEtc, \"startup.properties\"), new File(karafBase, \"etc/startup.properties\"));\n \n                 HashMap<String, String> props = new HashMap<String, String>();\n                 props.put(\"${SUBST-KARAF-NAME}\", name);\n",
  "files": 1,
  "linesAdd": 24,
  "linesRem": 4,
  "failing_tests": [
    "org.apache.karaf.instance.core.internal.InstanceServiceImplTest.testConfigurationFiles",
    "org.apache.karaf.instance.core.internal.InstanceServiceImplTest.testRenameInstance",
    "org.apache.karaf.instance.core.internal.InstanceServiceImplTest.testToSimulateRenameInstanceByExternalProcess"
  ],
  "nb_test": 21,
  "nb_failure": 0,
  "nb_error": 3,
  "nb_skipped": 0
}