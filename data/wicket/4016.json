{
  "files": 2, 
  "singleLine": false, 
  "nb_error": 1, 
  "failing_tests": [
    "callToStringFromConstructor(org.apache.wicket.MarkupContainerTest): Can not determine Markup. Component is not yet connected to a parent. [ToStringComponent [Component id = id]]"
  ], 
  "nb_test": 1180, 
  "patch": "diff --git a/wicket-core/src/main/java/org/apache/wicket/Component.java b/wicket-core/src/main/java/org/apache/wicket/Component.java\nindex 13b32cb..5f0a97d 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/Component.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/Component.java\n@@ -3207,23 +3207,22 @@ public abstract class Component\n \t{\n \t\ttry\n \t\t{\n+\t\t\tfinal StringBuilder buffer = new StringBuilder();\n+\t\t\tbuffer.append(\"[Component id = \").append(getId());\n+\n \t\t\tif (detailed)\n \t\t\t{\n \t\t\t\tfinal Page page = findPage();\n \t\t\t\tif (page == null)\n \t\t\t\t{\n-\t\t\t\t\treturn new StringBuilder(\"[Component id = \").append(getId())\n-\t\t\t\t\t\t.append(\", page = <No Page>, path = \")\n+\t\t\t\t\tbuffer.append(\", page = <No Page>, path = \")\n \t\t\t\t\t\t.append(getPath())\n \t\t\t\t\t\t.append('.')\n-\t\t\t\t\t\t.append(Classes.simpleName(getClass()))\n-\t\t\t\t\t\t.append(']')\n-\t\t\t\t\t\t.toString();\n+\t\t\t\t\t\t.append(Classes.simpleName(getClass()));\n \t\t\t\t}\n \t\t\t\telse\n \t\t\t\t{\n-\t\t\t\t\treturn new StringBuilder(\"[Component id = \").append(getId())\n-\t\t\t\t\t\t.append(\", page = \")\n+\t\t\t\t\tbuffer.append(\", page = \")\n \t\t\t\t\t\t.append(getPage().getClass().getName())\n \t\t\t\t\t\t.append(\", path = \")\n \t\t\t\t\t\t.append(getPath())\n@@ -3232,15 +3231,18 @@ public abstract class Component\n \t\t\t\t\t\t.append(\", isVisible = \")\n \t\t\t\t\t\t.append((determineVisibility()))\n \t\t\t\t\t\t.append(\", isVersioned = \")\n-\t\t\t\t\t\t.append(isVersioned())\n-\t\t\t\t\t\t.append(']')\n-\t\t\t\t\t\t.toString();\n+\t\t\t\t\t\t.append(isVersioned());\n+\t\t\t\t}\n+\n+\t\t\t\tif (markup != null)\n+\t\t\t\t{\n+\t\t\t\t\tbuffer.append(\", markup = \").append(new MarkupStream(getMarkup()).toString());\n \t\t\t\t}\n \t\t\t}\n-\t\t\telse\n-\t\t\t{\n-\t\t\t\treturn \"[Component id = \" + getId() + ']';\n-\t\t\t}\n+\n+\t\t\tbuffer.append(']');\n+\n+\t\t\treturn buffer.toString();\n \t\t}\n \t\tcatch (Exception e)\n \t\t{\ndiff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\nindex 056d483..f992264 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\n@@ -860,32 +860,26 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp\n \tpublic String toString(final boolean detailed)\n \t{\n \t\tfinal StringBuilder buffer = new StringBuilder();\n-\t\tbuffer.append(\"[\").append(this.getClass().getSimpleName()).append(\" \");\n+\t\tbuffer.append('[').append(this.getClass().getSimpleName()).append(' ');\n \t\tbuffer.append(super.toString(detailed));\n-\t\tif (detailed)\n+\t\tif (detailed && children_size() != 0)\n \t\t{\n-\t\t\tif (getMarkup() != null)\n-\t\t\t{\n-\t\t\t\tbuffer.append(\", markup = \").append(new MarkupStream(getMarkup()).toString());\n-\t\t\t}\n \n-\t\t\tif (children_size() != 0)\n-\t\t\t{\n-\t\t\t\tbuffer.append(\", children = \");\n+\t\t\tbuffer.append(\", children = \");\n \n-\t\t\t\t// Loop through child components\n-\t\t\t\tfinal int size = children_size();\n-\t\t\t\tfor (int i = 0; i < size; i++)\n+\t\t\t// Loop through child components\n+\t\t\tfinal int size = children_size();\n+\t\t\tfor (int i = 0; i < size; i++)\n+\t\t\t{\n+\t\t\t\t// Get next child\n+\t\t\t\tfinal Component child = children_get(i);\n+\t\t\t\tif (i != 0)\n \t\t\t\t{\n-\t\t\t\t\t// Get next child\n-\t\t\t\t\tfinal Component child = children_get(i);\n-\t\t\t\t\tif (i != 0)\n-\t\t\t\t\t{\n-\t\t\t\t\t\tbuffer.append(' ');\n-\t\t\t\t\t}\n-\t\t\t\t\tbuffer.append(child.toString());\n+\t\t\t\t\tbuffer.append(' ');\n \t\t\t\t}\n+\t\t\t\tbuffer.append(child.toString());\n \t\t\t}\n+\n \t\t}\n \t\tbuffer.append(']');\n \t\treturn buffer.toString();\n", 
  "project": "wicket", 
  "linesAdd": 29, 
  "nb_skipped": 2, 
  "fix_commit": "f1c9cef2", 
  "nb_failure": 0, 
  "id": "4016", 
  "linesRem": 33
}