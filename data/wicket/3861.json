{"nb_failure": 2, "nb_error": 0, "failing_tests": ["testRenderHomePage_2(org.apache.wicket.markup.outputTransformer.OutputTransformerContainerTest)", "testRenderHomePage(org.apache.wicket.markup.outputTransformer.OutputTransformerContainerTest)"], "patch": "diff --git a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\nindex ebbe98f..17f43d7 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/MarkupContainer.java\n@@ -1811,15 +1811,12 @@ public abstract class MarkupContainer extends Component implements Iterable<Comp\n \tprotected void onAfterRenderChildren()\n \t{\n \t\t// Loop through child components\n-\t\tfinal Iterator<? extends Component> iter = iterator();\n-\t\twhile (iter.hasNext())\n+\t\tfor (Component child : this)\n \t\t{\n-\t\t\t// Get next child\n-\t\t\tfinal Component child = iter.next();\n-\n \t\t\t// Call end request on the child\n \t\t\tchild.afterRender();\n \t\t}\n+\n \t\tsuper.onAfterRenderChildren();\n \t}\n \ndiff --git a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java\nindex 95cd456..9e26187 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/markup/MarkupResourceStream.java\n@@ -45,6 +45,9 @@ public class MarkupResourceStream implements IResourceStream, IFixedLocationReso\n \n \tprivate static final Logger log = LoggerFactory.getLogger(MarkupResourceStream.class);\n \n+\t/** */\n+\tpublic static final String WICKET_XHTML_DTD = \"http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd\";\n+\n \tprivate static final Pattern DOCTYPE_REGEX = Pattern.compile(\"!DOCTYPE\\\\s+(.*)\\\\s*\");\n \n \t/** The associated markup resource stream */\n@@ -68,10 +71,7 @@ public class MarkupResourceStream implements IResourceStream, IFixedLocationReso\n \t/** The encoding as found in <?xml ... encoding=\"\" ?>. Null, else */\n \tprivate String encoding;\n \n-\t/**\n-\t * Wicket namespace: <html\n-\t * xmlns:wicket=\"http://wicket.apache.org/dtds.data/wicket-xhtml1.3-strict.dtd>\n-\t */\n+\t/** Wicket namespace: see WICKET_XHTML_DTD */\n \tprivate String wicketNamespace;\n \n \t/** == wicket namespace name + \":id\" */\ndiff --git a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/AbstractTransformerBehavior.java b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/AbstractTransformerBehavior.java\nindex 0e82dc3..be0490b 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/AbstractTransformerBehavior.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/AbstractTransformerBehavior.java\n@@ -19,7 +19,6 @@ package org.apache.wicket.markup.transformer;\n import org.apache.wicket.Component;\n import org.apache.wicket.WicketRuntimeException;\n import org.apache.wicket.behavior.Behavior;\n-import org.apache.wicket.markup.ComponentTag;\n import org.apache.wicket.protocol.http.BufferedWebResponse;\n import org.apache.wicket.request.cycle.RequestCycle;\n import org.apache.wicket.request.http.WebResponse;\n@@ -59,12 +58,6 @@ public abstract class AbstractTransformerBehavior extends Behavior implements IT\n \t}\n \n \t@Override\n-\tpublic void onComponentTag(final Component component, final ComponentTag tag)\n-\t{\n-\t\ttag.put(\"xmlns:wicket\", \"http://wicket.apache.org\");\n-\t}\n-\n-\t@Override\n \tpublic void beforeRender(Component component)\n \t{\n \t\tsuper.beforeRender(component);\ndiff --git a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltOutputTransformerContainer.java b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltOutputTransformerContainer.java\nindex 873c476..d09c100 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltOutputTransformerContainer.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltOutputTransformerContainer.java\n@@ -18,6 +18,7 @@ package org.apache.wicket.markup.transformer;\n \n import org.apache.wicket.AttributeModifier;\n import org.apache.wicket.Component;\n+import org.apache.wicket.markup.MarkupResourceStream;\n import org.apache.wicket.markup.MarkupType;\n import org.apache.wicket.model.IModel;\n import org.apache.wicket.model.Model;\n@@ -74,7 +75,7 @@ public class XsltOutputTransformerContainer extends AbstractOutputTransformerCon\n \t\t// Make the XSLT processor happy and allow him to handle the wicket\n \t\t// tags and attributes which are in the wicket namespace\n \t\tadd(AttributeModifier.replace(\"xmlns:wicket\",\n-\t\t\tModel.of(\"http://wicket.apache.org/dtds.data/wicket-xhtml1.3-strict.dtd\")));\n+\t\t\tModel.of(MarkupResourceStream.WICKET_XHTML_DTD)));\n \t}\n \n \t/**\ndiff --git a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltTransformerBehavior.java b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltTransformerBehavior.java\nindex 97a1680..d1c3efa 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltTransformerBehavior.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/markup/transformer/XsltTransformerBehavior.java\n@@ -20,6 +20,7 @@ import org.apache.wicket.Component;\n import org.apache.wicket.Page;\n import org.apache.wicket.WicketRuntimeException;\n import org.apache.wicket.markup.ComponentTag;\n+import org.apache.wicket.markup.MarkupResourceStream;\n \n /**\n  * An IBehavior which can be added to any component except ListView. It allows to post-process\n@@ -69,10 +70,10 @@ public class XsltTransformerBehavior extends AbstractTransformerBehavior\n \t@Override\n \tpublic void onComponentTag(final Component component, final ComponentTag tag)\n \t{\n-\t\ttag.put(\"xmlns:wicket\", \"http://wicket.apache.org/dtds.data/wicket-xhtml1.3-strict.dtd\");\n-\n \t\t// Make the XSLT processor happy and allow it to handle the wicket tags\n \t\t// and attributes that are in the wicket namespace\n+\t\ttag.put(\"xmlns:wicket\", MarkupResourceStream.WICKET_XHTML_DTD);\n+\n \t\tsuper.onComponentTag(component, tag);\n \t}\n \ndiff --git a/wicket-core/src/main/java/org/apache/wicket/protocol/http/BufferedWebResponse.java b/wicket-core/src/main/java/org/apache/wicket/protocol/http/BufferedWebResponse.java\nindex 6ab2ef8..1fa461c 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/protocol/http/BufferedWebResponse.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/protocol/http/BufferedWebResponse.java\n@@ -132,7 +132,6 @@ public class BufferedWebResponse extends WebResponse implements IMetaDataBufferi\n \t\t@Override\n \t\tprotected void invoke(WebResponse response)\n \t\t{\n-\n \t\t\tAppendingStringBuffer responseBuffer = new AppendingStringBuffer(builder);\n \n \t\t\tList<IResponseFilter> responseFilters = Application.get()\n", "nb_test": 1242, "nb_skipped": 2, "fix_commit": "d1e0e411", "id": "3861"}