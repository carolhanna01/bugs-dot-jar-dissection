{
  "project": "flink",
  "jira_id": "18425",
  "commit": "00863a28",
  "classification": {
    "singleLine": false
  },
  "patch": "diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/GenericArrayData.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/GenericArrayData.java\nindex 08090127970..94060564892 100644\n--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/GenericArrayData.java\n+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/GenericArrayData.java\n@@ -244,39 +244,82 @@ public final class GenericArrayData implements ArrayData {\n \t// Conversion Utilities\n \t// ------------------------------------------------------------------------------------------\n \n+\tprivate boolean anyNull() {\n+\t\tfor (Object element : (Object[]) array) {\n+\t\t\tif (element == null) {\n+\t\t\t\treturn true;\n+\t\t\t}\n+\t\t}\n+\t\treturn false;\n+\t}\n+\n+\tprivate void checkNoNull() {\n+\t\tif (anyNull()) {\n+\t\t\tthrow new RuntimeException(\"Primitive array must not contain a null value.\");\n+\t\t}\n+\t}\n+\n \t@Override\n \tpublic boolean[] toBooleanArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (boolean[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Boolean[]) array);\n+\t}\n \n \t@Override\n \tpublic byte[] toByteArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (byte[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Byte[]) array);\n+\t}\n \n \t@Override\n \tpublic short[] toShortArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (short[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Short[]) array);\n+\t}\n \n \t@Override\n \tpublic int[] toIntArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (int[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Integer[]) array);\n+\t}\n \n \t@Override\n \tpublic long[] toLongArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (long[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Long[]) array);\n+\t}\n \n \t@Override\n \tpublic float[] toFloatArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (float[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Float[]) array);\n+\t}\n \n \t@Override\n \tpublic double[] toDoubleArray() {\n+\t\tif (isPrimitiveArray) {\n \t\t\treturn (double[]) array;\n \t\t}\n+\t\tcheckNoNull();\n+\t\treturn ArrayUtils.toPrimitive((Double[]) array);\n+\t}\n }\n \ndiff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/binary/BinaryArrayData.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/binary/BinaryArrayData.java\nindex 40526d59550..06374d06f40 100644\n--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/binary/BinaryArrayData.java\n+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/data/binary/BinaryArrayData.java\n@@ -434,7 +434,7 @@ public final class BinaryArrayData extends BinarySection implements ArrayData, T\n \n \tprivate void checkNoNull() {\n \t\tif (anyNull()) {\n-\t\t\tthrow new RuntimeException(\"Array can not have null value!\");\n+\t\t\tthrow new RuntimeException(\"Primitive array must not contain a null value.\");\n \t\t}\n \t}\n \n",
  "files": 2,
  "linesAdd": 44,
  "linesRem": 1,
  "failing_tests": ["org.apache.flink.table.data.DataStructureConvertersTest.testConversions"],
  "nb_test": 843,
  "nb_failure": 0,
  "nb_error": 1,
  "nb_skipped": 0
}