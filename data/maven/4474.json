{"files": 1, "singleLine": false, "nb_error": 0, "failing_tests": ["testPerLookupInstantiation(org.apache.maven.repository.legacy.DefaultWagonManagerTest)"], "nb_test": 173, "patch": "diff --git a/maven-compat/src/main/java/org/apache/maven/repository/legacy/DefaultWagonManager.java b/maven-compat/src/main/java/org/apache/maven/repository/legacy/DefaultWagonManager.java\nindex 00e7f38..0b4f3ae 100644\n--- a/maven-compat/src/main/java/org/apache/maven/repository/legacy/DefaultWagonManager.java\n+++ b/maven-compat/src/main/java/org/apache/maven/repository/legacy/DefaultWagonManager.java\n@@ -46,6 +46,7 @@ import org.codehaus.plexus.PlexusContainer;\n import org.codehaus.plexus.component.annotations.Component;\n import org.codehaus.plexus.component.annotations.Requirement;\n import org.codehaus.plexus.component.repository.exception.ComponentLifecycleException;\n+import org.codehaus.plexus.component.repository.exception.ComponentLookupException;\n import org.codehaus.plexus.logging.Logger;\n import org.codehaus.plexus.util.FileUtils;\n \n@@ -67,9 +68,6 @@ public class DefaultWagonManager\n     @Requirement\n     private PlexusContainer container;\n \n-    @Requirement(role = Wagon.class)\n-    private Map<String, Wagon> wagons;\n-\n     @Requirement\n     private UpdateCheckManager updateCheckManager;\n \n@@ -686,11 +684,16 @@ public class DefaultWagonManager\n         }\n \n         String hint = protocol.toLowerCase( java.util.Locale.ENGLISH );\n-        Wagon wagon = (Wagon) wagons.get( hint );\n \n-        if ( wagon == null )\n+        Wagon wagon;\n+        try\n+        {\n+            wagon = container.lookup( Wagon.class, hint );\n+        }\n+        catch ( ComponentLookupException e )\n         {\n-            throw new UnsupportedProtocolException( \"Cannot find wagon which supports the requested protocol: \" + protocol );\n+            throw new UnsupportedProtocolException( \"Cannot find wagon which supports the requested protocol: \"\n+                + protocol, e );\n         }\n \n         return wagon;\n", "project": "maven", "linesAdd": 9, "nb_skipped": 0, "fix_commit": "269c956e", "nb_failure": 1, "id": "4474", "linesRem": 6}